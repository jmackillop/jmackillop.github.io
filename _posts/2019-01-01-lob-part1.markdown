---
layout: post
title:  "Stochastic Modelling of Limit Order Books, Part 1"
date:   2019-01-01 15:01:26 +0100
categories: lob data
---


<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>

<p><i> This is the first in a series of posts that will look at how we might go about modelling limit order books. A particular focus will be put on the data side - while this post will look at the stochastic models, later parts will primarily examine available data to investigate the reliability of the models that we have. </i> </p>
<p>A large number of financial markets now employ a limit order book (LOB) system to process trades, including the New York, NASDAQ, Tokyo, London, and Euronext stock exchanges. In contrast to a quote-driven market, where only a limited number of market-makers are permitted to give the prices they are willing to buy and sell at (their bid and ask), a LOB system gives greater freedom to market participants. A patient LOB market participant may submit limit orders, which are added to the publicly visible order book (and may be cancelled until executed), while an impatient participant may submit market orders, which are immediately executed at the best available price against the limit orders in the order book. </p>

Due to the complex nature of the LOB system, it is necessary to make simplifying assumptions in order to be able to model the system. One of the key assumptions to be made is the origination of the orders, that is what is driving the order flow. Often it is assumed that the market consists of perfectly rational traders, who each try to maximise their own utility. Here we will instead focus on the zero-intelligence approach to modelling LOBs, led by physicists and mathematicians, which makes no such assumptions on the agents in the market, but rather assumes that they act randomly. Order flows are then directly modelled using stochastic processes, allowing for more tractable verification and simulation than other approaches. While the assumption of zero-intelligence is clearly a gross oversimplification, it provides an avenue to useful results, as will be demonstrated. As the statistician <a href="https://en.wikipedia.org/wiki/George_E._P._Box">George Box</a> is credited with having said, "All models are wrong, but some are useful."

From a historical point of view, <a href="http://www.numdam.org/article/ASENS_1900_3_17__21_0.pdf"> Louis Bachelier </a> is frequently credited with being the first to apply a mathematical, and more specifically, stochastic framework to finance . With the introduction of LOBs and their gradual replacement of quote-driven markets, discrete-time stochastic models for LOBs were <a href="https://arxiv.org/pdf/cond-mat/0106114.pdf">introduced at</a> the <a href="https://www.academia.edu/316653/Simple_Model_of_a_Limit_Order-Driven_Market">turn of the millennium</a>and the first continuous time LOB model was developed by <a href="http://tuvalu.santafe.edu/~desmith/PDF_pubs/e108102.pdf"> Daniels et. al. in 2003</a>. Various advancements and improvements to continuous time models have been made since then, some of which we will look at here.

<h1> LOB basics </h1>
We now provide a brief overview of how markets employing a LOB function, and some common terminology that will be used. 

Any trader participating in such a market can submit a buy (respectively sell) <strong>order</strong> $$x$$ at time $$t_x$$ with price $$p_x$$ and size $$\omega_x$$. This is a commitment to buy (resp. sell) $$\omega_x$$ quantity of the underlying asset at a price per unit less (resp. more) than or equal to $$p_x$$. The <strong>lot size</strong> is the smallest quantity of the asset that may be traded, and all order sizes must be multiples of it. The <strong>tick size</strong>, $$\delta$$, is the smallest allowed difference in price between orders, and all order prices must be a multiple of the tick size. In USD denominated stock markets, the tick size is frequently $0.01, although this varies, and is frequently several orders of magnitude smaller in markets such as foreign exchange. The <strong>bid price</strong> at time $$t$$, $$b(t)$$,  is the largest price among the buy orders that are on the book at time $$t$$, and similarly the <strong>ask price</strong> $$a(t)$$ is the smallest among the sell orders. The <strong>bid-ask spread</strong>, commonly referred to as the spread, is the difference between the bid price and the ask price. The <strong>mid price</strong>, $$m(t)$$, at time $$t$$ is defined to be the mid point between the bid price and the ask price, that is $$m(t)= \frac{a(t)+b(t)}{2}$$

If the price at which a buy order is submitted, $$p_x$$, is greater than or equal to the ask price, $$a(t)$$, then the order is executed immediately at the best available price against the sell orders on the book. This is referred to as a <strong>market order</strong>. Otherwise, the buy order is added to the order book, and is referred to as a <strong>limit order</strong>, which gives the LOB its name. The market operates similarly, with the obvious changes, when a sell order is submitted. Other than being executed against by a market order, limit orders may only be removed from the book due to a <strong>cancellation</strong> by the trader who submitted them. Traders are permitted to cancel limit orders at any time up to the moment they are filled by a market order. 

When a market order arrives, the limit orders to be executed against are chosen first by price, and then, among limit orders at the same price, by priority. Typically this is based on when the limit orders were submitted, with earlier submissions gaining higher priority. It is common to refer to the limit orders on the book at a given price as a queue, with the queues corresponding to buy and sell limit orders referred to as <strong>bid queues</strong> and <strong>ask queues</strong> respectively. The queues at $$b(t)$$ and $$a(t)$$ are together referred to as the <strong>best queues</strong>.

This is summarised in the figure below.
![Figure 1](/assets/images/Generic_LOB_plot.jpeg) 
The bid queues are in green and the ask queues are in red. In this case, the lot size is 1 and $$\delta = 0.01$$. The bid-ask spread is 2 ticks as $$a(t)-b(t) = 1.06-1.04 = 2\delta$$. If a buy order of size 2 is submitted at price $1.04, shown in blue, then it will be added to the order book at $1.04 because 1.04 < a(t). If the buy order had instead been submitted at a price $1.06, it would have executed against the ask limit orders, and reduced the ask price queue to size 4-2=2.